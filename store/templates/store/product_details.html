{% extends "base.html" %}
{% block content %}
<div class="container my-4">
    <h2 class="mt-2">{{ product.name }}</h2>

    {% with photo=product.get_product_image %}
    {% if photo %}
    <img src="{{ photo.image.url }}" alt="{{ product.name }}" style="max-width:300px;">
    {% endif %}
    {% endwith %}

    {% if product.description %}
    <p class="mt-3">{{ product.description }}</p>
    {% endif %}

    <div class="mt-3" style="max-width:420px;">

        <form action="{% url 'basket:add_to_basket' %}" method="post">
            {% csrf_token %}
            <label for="variant" class="form-label">Choose a variant</label>
            <select id="variant" name="variant_id" class="form-select mb-3">
                {% for v in product.variants.all %}
                {% with qty=v.stock.quantity|default:0 %}
                <option value="{{ v.id }}">
                    {{ v.size|default:"" }} / {{ v.colour|default:"" }} Â£{{ v.price }} ({{ qty }} left)
                </option>
                {% endwith %}
                {% endfor %}
            </select>

            <label for="qty" class="ms-2">Qty</label>
            <input id="qty" name="qty" type="number" min="1" value="1" style="width:80px;">

            <button type="submit" class="btn btn-primary">Add to Basket</button>
        </form>

    </div>
</div>
{% endblock %}